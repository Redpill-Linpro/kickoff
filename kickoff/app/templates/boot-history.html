{% include "header.html" %}

{% if mac %}
  {% include "mac_menu.html" %}
  <h2>Boot history</h2>
  <p class="lead">This is the entire net boot history of the MAC address {{ mac }}.
{% else %}
  {% if status == 1 %}
    <h1>Discovered hosts</h1>
  {% else %}
    <h1>Boot history</h1>
  {% endif %}
{% endif %}

<table class="table table-hover">
  <thead>
    <tr>
     <th><span class="glyphicon glyphicon-time"></span></th>
     <th>Timestamp</th>
     {% if not mac %}
       <th>MAC</th>
     {% endif %}
     <th>IP</th>
     <th>Hostname</th>
     <th>UUID</th>
     <th>DNS</th>
     <th></th>
    </tr>
  </thead>
  <tbody>
  {% for i in entries %}
    {% if i.status == 0 %}
    <tr class="danger">
    {% else %}
    <tr>
    {% endif %}
      <td>{{ i.age }}</td>
      <td>{{ i.registered }}</td>
      {% if not mac %}
        <td><a href="/mac/{{ i.mac }}">{{ i.mac }}</a></td>
      {% endif %}
      <td>{{ i.remote_addr }}</td>
      <td>
        {% if i.hostname %}
          {{ i.hostname }}
        {% else %}
          <small>N/A</small>
        {% endif %}
      </td>
      <td>
         {% if i.uuid %}
           {{ i.uuid }}
         {% else %}
           <small>N/A</small>
         {% endif %}
      </td>
      <td>
            {% if i.reverse %}
              {% if mac %}
                {{ i.reverse }}
              {% else %}
                <a href="/mac/{{ i.mac }}">
                  {{ i.reverse }}
                </a>
              {% endif %}
            {% else %}
              <span class="label label-info">Lookup failed</span>
            {% endif %}
      </td>
      <td>
        {% if i.status == 0 %}
          <a href="/mac/{{ i.mac }}/security"><span class="glyphicon glyphicon-ban-circle" rel="tooltip" title="Permission denied by the security filters"></span></a>
        {% elif i.status == 1 %}
          <a href="/mac/{{ i.mac }}/configuration"><span class="glyphicon glyphicon-eye-open" rel="tooltip" title="The host was discovered"></span></a>
        {% elif i.status == 2 %}
          <a href="/mac/{{ i.mac }}/configuration"><span class="glyphicon glyphicon-hdd" rel="tooltip" title="Served default configuration"></span></a>
        {% elif i.status == 3 %}
          <a href="/mac/{{ i.mac }}/configuration"><span class="glyphicon glyphicon-cloud-download" rel="tooltip" title="Served custom configuration"></span></a>
        {% endif %}

        <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#{{ i.id }}">
          <span class="glyphicon glyphicon-info-sign" rel="tooltip" title="Click to show/hide the iPXE configuration that was served."></span>
        </a>
      </td>
    </tr>
    <tr id="{{ i.id }}" class="panel-collapse collapse">
      <td colspan="8">
        <div>
          <div class="panel-body">
            <pre>{{ i.ipxe }}</pre>
          </div>
        </div>
      </td>
    </tr>
  {% endfor %}
  </tbody>
</table>

{% include "footer.html" %}
